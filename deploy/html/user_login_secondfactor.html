{%- extends "viur_base.html" %}

{%- block content %}
	{% if action == "otp" or action == "authenticatorOTP"  %}
		<h1 class="headline">{{ action }}</h1>

		<form action="/user/f2_{{ action|lower }}/otp" method="POST" class="">
			<input name="skey" type="hidden" value="{{ getSecurityKey() }}">

			{% for error in skel["errors"] %}
				<div class="msg msg--error is-active">
					{{ embedSvg("icon-cross") }}
					<div class="msg-content">
						<h3 class="msg-headline">{{ error["errorMessage"] }}</h3>
					</div>
				</div>
			{% endfor %}

			<div class="msg msg--error {{ "is-active" if secondFactorFailed }}">
				{{ embedSvg("icon-cross") }}
				<div class="msg-content">
					<h3 class="msg-headline">Error!</h3>
					<p>The entered token was invalid!</p>
				</div>
			</div>

			<div class="input-group">
				<label class="label has-icon" for="otptoken">{{ embedSvg("icon-token") }}OTP Token</label>
				<input id="username" name="otptoken" type="text" class="input js-focus" placeholder="OTP Token">
			</div>

			<button type="submit" id="submitbtn" name="submit" class="btn btn--primary">Login</button>
		</form>
	{% else %}
		<div>Unimplemented second factor action: {{ action }}</div>
	{% endif %}
{%- endblock content %}
